# docker
chmod 400 file_name
bash file_name

# authenticate artifact registry in your host, replace region with yours
gcloud auth configure-docker us-east1-docker.pkg.dev
gcloud auth print-access-token | sudo docker login -u oauth2accesstoken --password-stdin  us-central1-docker.pkg.dev


# install gcp gke auth tools
sudo apt-get install kubectl
sudo apt-get install google-cloud-sdk-gke-gcloud-auth-plugin

# authenticate your cluster with gcp , replace name, cluster and project with your values
gcloud container clusters get-credentials gke-cluster --region us-central1 --project gcp-kubernetes-project-402813


# pull bitnami image, tag and push it to our gcp registry
# note this is the name in our nodejs app for the db uri
sudo docker pull docker.io/bitnami/mongodb:4.4.4
sudo docker tag docker.io/bitnami/mongodb:4.4.4 us-central1-docker.pkg.dev/gcp-kubernetes-project-402813/my-repository/bitnami:v1
sudo docker push us-central1-docker.pkg.dev/gcp-kubernetes-project-402813/my-repository/bitnami:v1


# kubectl
kubectl create -f file_name
kubectl get all -n database

sudo docker build -t us-central1-docker.pkg.dev/gcp-kubernetes-project-402813/my-repository/node:v1 .
sudo docker push  us-central1-docker.pkg.dev/gcp-kubernetes-project-402813/my-repository/node:v1

# test
kubectl delete pod pod_name -n database